---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dpi = 300,
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# melt - Multiple Empirical Likelihood Tests
<!-- badges: start -->
[![Project Status: Active - The project has reached a stable, usable state and is being actively developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
[![CRAN status](https://www.r-pkg.org/badges/version/melt)](https://CRAN.R-project.org/package=melt)
[![R-CMD-check](https://github.com/markean/melt/actions/workflows/check-standard.yaml/badge.svg)](https://github.com/markean/melt/actions/workflows/check-standard.yaml)
[![Codecov test coverage](https://codecov.io/gh/markean/melt/branch/master/graph/badge.svg)](https://app.codecov.io/gh/markean/melt?branch=master)
<!-- badges: end -->

## Overview
Empirical likelihood enables a nonparametric, likelihood-driven style of inference without relying on assumptions frequently made in parametric models.
Empirical likelihood-based tests are asymptotically pivotal and thus avoid explicit studentization, making it also challenging for the methods to be directly extended to other packages for parametric models. 
The R package [melt](https://cran.r-project.org/package=melt) aims to bridge the gap and provide a unified framework for data analysis with empirical likelihood methods.
A collection of functions are available to perform multiple empirical likelihood tests and construct confidence intervals for linear and generalized linear models in R.
The package offers an easy-to-use interface and flexibility in specifying hypotheses and calibration methods, extending the framework to simultaneous inference.
The core computational routines are implemented with the [Eigen](https://eigen.tuxfamily.org/index.php?title=Main_Page) C++ library and [RcppEigen](https://cran.r-project.org/package=RcppEigen) interface, with OpenMP for parallel computation. 
Details of the testing procedures are given in [Kim, MacEachern, and Peruggia (2021)](https://arxiv.org/abs/2112.09206). 
This work was supported by the U.S. National Science Foundation under Grants No. [SES-1921523](https://nsf.gov/awardsearch/showAward?AWD_ID=1921523) and [DMS-2015552](https://nsf.gov/awardsearch/showAward?AWD_ID=2015552).

## Installation
You can install the latest stable release from [CRAN](https://cran.r-project.org/package=melt).
```{r eval = FALSE}
install.packages("melt")
```
You can install the latest development version from
[Github](https://github.com/markean/melt).
```{r eval = FALSE}
# install.packages("devtools")
devtools::install_github("markean/melt")
```


## Usage
```{r usage, eval = TRUE}
library(melt)

# Test for the mean
data("precip")
fit <- el_mean(precip, par = 30)
fit


# Linear regression
data("mtcars")
fit2 <- el_lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
summary(fit2)
cr <- confreg(fit2, parm = c("disp", "hp"), npoints = 200)
plot(cr)


# Analysis of variance
data("clothianidin")
fit3 <- el_lm(clo ~ -1 + trt, data = clothianidin)
summary(fit3)
confint(fit3)


# Test of no treatment effect
contrast <- matrix(c(
  1, -1, 0, 0,
  0, 1, -1, 0,
  0, 0, 1, -1
), byrow = TRUE, nrow = 3)
elt(fit3, lhs = contrast)
```
