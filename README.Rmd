---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dpi = 300,
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# melt - Multiple Empirical Likelihood Tests <a href="https://markean.github.io/melt/"><img src="man/figures/logo.png" align="right" height="139" /></a>

<!-- badges: start -->
[![Project Status: Active - The project has reached a stable, usable state and is being actively developed.](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
[![CRAN status](https://www.r-pkg.org/badges/version/melt)](https://CRAN.R-project.org/package=melt)
[![R-CMD-check](https://github.com/markean/melt/actions/workflows/check-standard.yaml/badge.svg)](https://github.com/markean/melt/actions/workflows/check-standard.yaml)
[![Codecov test coverage](https://codecov.io/gh/markean/melt/branch/master/graph/badge.svg)](https://app.codecov.io/gh/markean/melt?branch=master)
<!-- badges: end -->

## Overview
Empirical likelihood enables a nonparametric, likelihood-driven style of inference without relying on assumptions frequently made in parametric models.
Empirical likelihood-based tests are asymptotically pivotal and thus avoid explicit studentization.
For this reason it is challenging to incorporate empirical likelihood methods directly into other packages that perform inferences for parametric models.
The R package [melt](https://cran.r-project.org/package=melt) aims to bridge the gap and provide a unified framework for data analysis with empirical likelihood methods.
A collection of functions are available to perform multiple empirical likelihood tests and construct confidence intervals for linear and generalized linear models in R.
The package offers an easy-to-use interface and flexibility in specifying hypotheses and calibration methods, extending the framework to simultaneous inferences.
The core computational routines are implemented with the [Eigen](https://eigen.tuxfamily.org/index.php?title=Main_Page) C++ library and [RcppEigen](https://cran.r-project.org/package=RcppEigen) interface, with OpenMP for parallel computation. 
Details of the testing procedures are given in [Kim, MacEachern, and Peruggia (2021)](https://arxiv.org/abs/2112.09206). 
This work was supported by the U.S. National Science Foundation under Grants No. [SES-1921523](https://nsf.gov/awardsearch/showAward?AWD_ID=1921523) and [DMS-2015552](https://nsf.gov/awardsearch/showAward?AWD_ID=2015552).

## Installation
You can install the latest stable release from [CRAN](https://cran.r-project.org/package=melt).
```{r eval = FALSE}
install.packages("melt")
```
You can install the latest development version from
[Github](https://github.com/markean/melt).
```{r eval = FALSE}
# install.packages("devtools")
devtools::install_github("markean/melt")
```

## Main functions
melt provides an intuitive API for performing the most common data analysis tasks:

* `el_lm()` fits a linear model with empirical likelihood.
* `el_glm()` fits a generalized linear model with empirical likelihood.
* `confint()` computes confidence intervals for model parameters.
* `confreg()` computes confidence region for model parameters.
* `elt()` tests a linear hypothesis.
* `elmt()` performs multiple testing simultaneously.

## Usage
```{r usage, eval = TRUE}
library(melt)
set.seed(971112)

## Test for the mean
data("precip")
el_mean(precip, par = 30)


## Linear model
data("mtcars")
fit_lm <- el_lm(mpg ~ disp + hp + wt + qsec, data = mtcars)
summary(fit_lm)
cr <- confreg(fit_lm, parm = c("disp", "hp"), npoints = 200)
plot(cr)
data("clothianidin")
fit2_lm <- el_lm(clo ~ -1 + trt, data = clothianidin)
summary(fit2_lm)
confint(fit2_lm)


## Generalized linear model
data("thiamethoxam")
fit_glm <- el_glm(visit ~ log(mass) + fruit + foliage + var + trt,
  family = quasipoisson(link = "log"), data = thiamethoxam,
  control = el_control(maxit = 100, tol = 1e-08, nthreads = 4)
)
summary(fit_glm)


## Test of no treatment effect
contrast <- c(
  "trtNaked - trtFungicide", "trtFungicide - trtLow", "trtLow - trtHigh"
)
elt(fit2_lm, lhs = contrast)


## Multiple testing
contrast2 <- rbind(
  c(0, 0, 0, 0, 0, 1, 0, 0),
  c(0, 0, 0, 0, 0, 0, 1, 0),
  c(0, 0, 0, 0, 0, 0, 0, 1)
)
elmt(fit_glm, lhs = contrast2)
```
